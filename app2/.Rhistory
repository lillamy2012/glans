mod[[100]]
v[[100]]
pos=lapply(v,function(x) x[!is.na(x)])
neww = list()
for(i in 1:length(v)){
neww[[i]]= data.frame(mod[[i]],pos[[i]])
}
neww
newdf = do.call("rbind",neww)
newdf
table(newdf)
indind
indind$Modifications
table(newdf)
table(indind$Modifications)
66        +               1        +              28
ind
tt[80]
table(newdf)
tt[24]
tt[28]
tt[77]
table(indind$Modifications)
point(as.numeric(colnames(table(newdf))))
points(as.numeric(colnames(table(newdf))))
points(x=as.numeric(colnames(table(newdf))))
points(x=as.numeric(colnames(table(newdf))),col="red",pch=1)
points(x=as.numeric(colnames(table(newdf))),col="red",pch=1,y=rep(40,4))
plot(mat)
points(x=as.numeric(colnames(table(newdf))),col="red",pch=1,y=rep(40,4))
plot(mat)
points(x=80,y=23,col="red",pch=18)
points(x=80,y=4,col="green",pch=18)
points(x=77,y=1,col="blue",pch=18)
points(x=c(24,28),y=c(1,1),col="red",pch=18)
plot(mat,typ="l")
points(x=c(24,28),y=c(1,1),col="red",pch=18)
points(x=77,y=1,col="blue",pch=18)
points(x=80,y=4,col="green",pch=18)
points(x=80,y=23,col="red",pch=18)
barplot(mat)
barplot(mat,beside=T)
?barplot
mat
table(indind$Modifications)
table(newdf)
matt = matrix(0,nrow(mat),3)
matt
matt[,1]=mat
table(newdf)
matt[c(24,26,80),2]
matt[c(24,26,80),2]=c(1,1,28)
matt[77,3]=1
matt
matt = matrix(0,nrow(mat),4)
matt[,1]=mat
matt[c(24,26,80),2]=c(1,1,28)
matt[77,3]=1
table(newdf)
matt[c(80),4]=c(4)
matt
barplot(matt)
barplot(t(matt))
matt[,1]=matt[,1]-rowSums(matt[,2:4])
barplot(t(matt))
barplot(t(matt),col=c("red","blue","orange","grey"))
barplot(t(matt[,4:1]),col=c("red","blue","orange","grey"))
barplot(t(matt[,4:1]),col=c("red","blue","orange","lightgrey"))
barplot(t(matt[,4:1]),col=c("red","blue","green","lightgrey"))
barplot(t(matt[,4:1]),col=c("red","blue","green","lightgrey"))
axes(1,1:137)
axis(1,1:137)
barplot(t(matt[,4:1]),col=c("red","blue","green","lightgrey"))
?barplot
barplot(t(matt[,4:1]),col=c("red","blue","green","lightgrey"),names.arg = tt)
barplot(t(matt[,4:1]),col=c("red","blue","green","lightgrey"),names.arg = tt,cex=0.4)
barplot(t(matt[,4:1]),col=c("red","blue","green","lightgrey"),names.arg = tt)
barplot(t(matt[,4:1]),col=c("red","blue","green","lightgrey"),names.arg = tt,cex.names=0.4)
barplot(t(matt[,4:1]),col=c("red","blue","green","lightgrey"),names.arg = tt,cex.names=0.1)
barplot(t(matt[,4:1]),col=c("red","blue","green","lightgrey"),names.arg = tt,cex.names=0.4)
barplot(t(matt[,4:1]),col=c("red","blue","green","lightgrey"),names.arg = tt,cex.names=0.2)
uu = rep("",137)
uu[80]="K"
barplot(t(matt[,4:1]),col=c("red","blue","green","lightgrey"),names.arg = uu,cex.names=0.2)
barplot(t(matt[,4:1]),col=c("red","blue","green","lightgrey"),names.arg = uu,cex.names=0.4)
barplot(t(matt[,4:1]),col=c("red","blue","green","lightgrey"),names.arg = uu
)
uu
barplot(t(matt[,4:1]),col=c("red","blue","green","lightgrey"),names.arg = uu,cex.names=0.2)
barplot(t(matt[,4:1]),col=c("red","blue","green","lightgrey"),names.arg = uu,cex.names=0.3)
barplot(t(matt[,4:1]),col=c("red","blue","green","lightgrey"),names.arg = uu,cex.names=0.4)
barplot(t(matt[,4:1]),col=c("red","blue","green","lightgrey"),names.arg = uu,cex.names=0.5)
barplot(t(matt[,4:1]),col=c("red","blue","green","lightgrey"),names.arg = uu,cex.names=0.4)
barplot(t(matt[,4:1]),col=c("red","blue","green","white"),names.arg = uu,cex.names=0.4)
?text
text(80,2,"KK")
text(80/137,2,"K")
text(80/137*100,2,"K")
text(80/137*200,2,"K")
text(80/137*1370,2,"K")
text(80/137*137,2,"K")
text(80/137*150,2,"K")
text(80/137*155,2,"K")
text(80/137*160,2,"K")
text(80/137*163,2,"K")
text(80/137*163,-2,"K")
text(80/137*163,85,"K")
text(80/137*164,85,"K")
? barplot
barplot(t(matt[,4:1]),col=c("red","blue","green","white"),names.arg = uu,cex.names=0.4,xlim=c(0,137))
text(80,85,"K")
text(o,85,"K")
text(0,85,"K")
text(1,85,"K")
text(137,85,"K")
example("barplot")
?mtext
?barplot
mm = barplot(t(matt[,4:1]),col=c("red","blue","green","white"),names.arg = uu,cex.names=0.4,xlim=c(0,137))
u
uu
mtext(side=1,at = colMeans(mm))
mtext(side=1,at = colMeans(mm),uu)
mp <- barplot(hh, beside = TRUE,
col = c("lightblue", "mistyrose",
"lightcyan", "lavender"),
legend = colnames(VADeaths), ylim = c(0,100),
main = "Death Rates in Virginia", font.main = 4,
sub = "Faked upper 2*sigma error bars", col.sub = mybarcol,
cex.names = 1.5)
mp
mm = barplot(t(matt[,4:1]),col=c("red","blue","green","white"),names.arg = uu,cex.names=0.4,xlim=c(0,137))
mm
mtext(side=1,at = mm,uu)
matt[77,3]=1matt[77,3]=1
uu = rep(0,nrow(matt))
matt = matrix(0,nrow(mat),4)
matt[,1]=mat
matt[c(24,26,80),2]=c(1,1,28)
matt[77,3]=1
matt[c(80),4]=c(4)
matt[,1]=matt[,1]-rowSums(matt[,2:4])
mm = barplot(t(matt[,4:1]),col=c("red","blue","green","white"))
uu = rep(0,nrow(matt))
isnot = which(rowSums(matt[,2:4])>0)
uu[isnot]=tt[isnot]
mtext(side=1,at = mm,uu)
mm = barplot(t(matt[,4:1]),col=c("red","blue","green","white"))
uu = rep("",nrow(matt))
isnot = which(rowSums(matt[,2:4])>0)
uu[isnot]=tt[isnot]
mtext(side=1,at = mm,uu)
matt[c(24,26,80),2]=c(1,1,28)
table(newdf)
table(indind$Modifications)
indind[which(indind$Modifications=="K6(Acetyl); K10(Acetyl)"),]
ind
mod[83]
pos[83]
indind[which(indind$Modifications=="K6(Acetyl); K10(Acetyl)"),]
tt[24]
tt[25]
tt[26]
tt[27]
tt[28]
uu
isnot
table(newdf)
matt[c(24,28,80),2]=c(1,1,28)
matt[77,3]=1
matt[c(80),4]=c(4)
matt[,1]=matt[,1]-rowSums(matt[,2:4])
mm = barplot(t(matt[,4:1]),col=c("red","blue","green","white"))
uu = rep("",nrow(matt))
isnot = which(rowSums(matt[,2:4])>0)
uu[isnot]=tt[isnot]
mtext(side=1,at = mm,uu)
matt = matrix(0,nrow(mat),4)
matt[,1]=mat
matt[c(24,28,80),2]=c(1,1,28)
matt[77,3]=1
matt[c(80),4]=c(4)
matt[,1]=matt[,1]-rowSums(matt[,2:4])
mm = barplot(t(matt[,4:1]),col=c("red","blue","green","white"))
uu = rep("",nrow(matt))
isnot = which(rowSums(matt[,2:4])>0)
uu[isnot]=tt[isnot]
mtext(side=1,at = mm,uu)
barplot(t(asinh(matt[,4:1])),col=c("red","blue","green","white"))
barplot(t(log(matt[,4:1])),col=c("red","blue","green","white"))
barplot(t(log(matt[,4:1]+1)),col=c("red","blue","green","white"))
matt[,4:1
]
mm = barplot(t(matt[,4:1]),col=c("red","blue","green","white"))
mtext(side=1,at = mm,uu)
newdf = do.call("rbind",neww)
class(newdf)
class(table(newdf))
as.matrix(table(newdf))
nr = as.matrix(table(newdf))
matt = matrix(0,nrow(mat),nrow(nr))
matt[,1]=mat
matt[nr[1,],2]=nr[2,]
matt[nr[1,],2]
nr[1,]
dim(nr)
dim(matt)
matt[as.numeric(colnames(nr)),2]=nr[1,]
matt[as.numeric(colnames(nr)),2]
matt[as.numeric(colnames(nr)),]
as.numeric(colnames(nr)
)
matt[,1]=matt[,1]-rowSums(matt[,2:ncol(matt)])
mm = barplot(t(matt[,4:1]),col=c("red","blue","green","white"))
matt
matt = matrix(0,nrow(mat),nrow(nr)+1)
matt
matt[,1]=mat
matt[as.numeric(colnames(nr)),2]=nr[1,]
matt[as.numeric(colnames(nr)),3]=nr[2,]
matt[as.numeric(colnames(nr)),4]=nr[3,]
matt[,1]=matt[,1]-rowSums(matt[,2:ncol(matt)])
mm = barplot(t(matt[,4:1]),col=c("red","blue","green","white"))
uu = rep("",nrow(matt))
isnot = which(rowSums(matt[,2:4])>0)
uu[isnot]=tt[isnot]
mtext(side=1,at = mm,uu)
rm(list=l())
rm(list=ls())
source('~/glans/app2/test2.R')
source('~/glans/app2/test2.R')
source('~/glans/app2/test2.R')
test="MARTKQTARKSTGGKAPRKQLATKAARKSAPATGGVKKPHRFRPGTVALREIRKYQKSTELLIRKLPFQRLVREIAQDFKTDLRFQSSAVAALQEAAEAYLVGLFEDTNLCAIHAKRVTIMPKDIQLARRIRGERA*"
source('~/glans/app2/test2.R')
mod[[i]]
pos[[i]]
i
ind[34]
bb[34,]
bb[34]
indind[34,]
tt
grep("N-Term",bb)
?ggrep
?grep
sub("N-Term",1,bb)
rm(list=ls())
source('~/glans/app2/test2.R')
source('~/glans/app2/test2.R')
matt
length(test)
length(t)
length(tt)
test="MARTKQTARKSTGGKAPRKQLATKAARKSAPATGGVKKPHRFRPGTVALREIRKYQKSTELLIRKLPFQRLVREIAQDFKTDLRFQSSAVAALQEAAEAYLVGLFEDTNLCAIHAKRVTIMPKDIQLARRIRGERA*"
tt = strsplit(test,"")[[1]]
length(tt)
cols =c("maroon","pink","brown","yellow","orange","red","blue","green","white")
source('~/glans/app2/test2.R')
source('~/glans/app2/test2.R')
nr
rowSums(nr)
shiny::runApp()
ind
hh = do.call("rbind",ind)
hh
table(hh)
head(hh)
table(hh$start)
table(hh[,"start"])
table(hh[,"end"])
newdf
matt[20,]
nr
head(matt)
mat[19:22,]
matt[19:22,]
nr
matt = matrix(0,nrow(mat),nrow(nr)+1)
matt[,1]=mat
for(i in 1:nrow(nr)){
matt[as.numeric(colnames(nr)),i+1]=nr[i,]
}
matt[,1]=matt[,1]-rowSums(matt[,2:ncol(matt)])
source('~/glans/app2/test2.R')
matt[20,]
rm(list=ls())
source('~/glans/app2/test2.R')
matt
mm = barplot(t(matt[,ncol(matt):1]),col=cols[3:9])
nr
uu = rep("",nrow(matt))
isnot = which(rowSums(matt[,2:ncol(matt)])>0)
uu[isnot]=tt[isnot]
mtext(side=1,at = mm,uu)
source('~/glans/app2/test2.R')
i
mod[[i]]
pos[[i]]
ind
source('~/glans/app2/test2.R')
need= ncol(matt)
need
9-need
9-need+1
source('~/glans/app2/test2.R')
grep("AT4G27230|H2A.2",indata$Accession)
indind = indata[which(indata$Accession=="AT4G27230|H2A.2"),]
indind
dim(indind)
index=grep("AT4G27230|H2A.2",indata$Accession)
indind=indata[index,]
source('~/glans/app2/test2.R')
i
mod[[i]]
pos[[i]]
ind[[i]]
indind[58,]
source('~/glans/app2/test2.R')
source('~/glans/app2/test2.R')
i
mod[[i]]
pos[[i]]
ind[[i]]
bb[[i]]
indind[i,]
index=grep("AT3G27360|H3.1",indata$Accession)
indind=indata[index,]
unique(indind$Accession)
grep("AT3G27360|H3.1",indata$Accession)
indata[9994,]
grep("AT3G27360|H3.1",indata$Accession[9994])
indata$Accession[9994]
grep("AT3G27360\\|H3.1",indata$Accession[9994])
grep("AT3G27360\\|H3.1",indata$Accession)
index=grep("AT3G27360\\|H3.1",indata$Accession)
indind=indata[index,]
source('~/glans/app2/test2.R')
matt
dim(matt)
source('~/glans/app2/test2.R')
?barplot
mm = barplot(t(matt[,ncol(matt):1]),col=cols[(length(cols)-need+1):length(cols)],border = NA)
cols =c("darkblue","maroon","pink","brown","yellow","orange","red","blue","green","lightgrey")
need= ncol(matt)
mm = barplot(t(matt[,ncol(matt):1]),col=cols[(length(cols)-need+1):length(cols)],border = NA)
legend("topright",col=cols[(length(cols)-need+1):length(cols)],legend=colnames(matt)[ncol(matt):1])
olnames(matt)[ncol(matt):1]
legend("topright",col=cols[(length(cols)-need+1):length(cols)],legend=colnames(newdf)[ncol(matt):1])
nr
rownames(nr)
legend("topright",col=cols[(length(cols)-need+1):length(cols)],legend=rownames(nr))
legend("topright",col=cols[(length(cols)-need+1):length(cols)],legend=rownames(nr),fill=cols[(length(cols)-need+1):length(cols)])
legend("topright",legend=rownames(nr),fill=cols[(length(cols)-need+1):length(cols)])
mm = barplot(t(matt[,ncol(matt):1]),col=cols[(length(cols)-need+1):length(cols)],border = NA)
legend("topright",legend=rownames(nr),fill=cols[(length(cols)-need+1):length(cols)])
rowSums(nr)
legend("topright",legend=rownames(nr),fill=cols[length(cols):(length(cols)-need+1):])
mm = barplot(t(matt[,ncol(matt):1]),col=cols[(length(cols)-need+1):length(cols)],border = NA)
legend("topright",legend=rownames(nr),fill=cols[length(cols):(length(cols)-need+1)])
source('~/glans/app2/test2.R')
mm = barplot(t(matt[,ncol(matt):1]),col=cols[(length(cols)-need+1):length(cols)],border = NA)
uu = rep("",nrow(matt))
isnot = which(rowSums(matt[,2:ncol(matt)])>0)
uu[isnot]=tt[isnot]
mtext(side=1,at = mm,uu,cex=0.8)
legend("topright",legend=c("no mod.",rownames(nr)),fill=cols[length(cols):(length(cols)-need+1)])
tt
num=1:length(tt)
num[!isnot]=""
num
isnot
num[!num%in%isnot]=""
num
text(x=mm,y=-2,num)
text(x=mm,y=-5,num)
text(x=mm,y=-10,num)
?mtext
mtext(side=1,at = mm,num,cex=0.8,line=-1)
mm = barplot(t(matt[,ncol(matt):1]),col=cols[(length(cols)-need+1):length(cols)],border = NA)
mtext(side=1,at = mm,uu,cex=0.8)
mtext(side=1,at = mm,num,cex=0.8,line=-1)
mm = barplot(t(matt[,ncol(matt):1]),col=cols[(length(cols)-need+1):length(cols)],border = NA)
uu = rep("",nrow(matt))
isnot = which(rowSums(matt[,2:ncol(matt)])>0)
uu[isnot]=tt[isnot]
mtext(side=1,at = mm,uu,cex=0.8)
num=1:length(tt)
num[!num%in%isnot]=""
#text(x=mm,y=-10,num)
mtext(side=1,at = mm,num,cex=0.8,line=5)
mtext(side=1,at = mm,num,cex=0.8,line=2)
mtext(side=1,at = mm,num,cex=0.8,line=1)
mm = barplot(t(matt[,ncol(matt):1]),col=cols[(length(cols)-need+1):length(cols)],border = NA)
uu = rep("",nrow(matt))
isnot = which(rowSums(matt[,2:ncol(matt)])>0)
uu[isnot]=tt[isnot]
mtext(side=1,at = mm,uu,cex=0.8)
num=1:length(tt)
num[!num%in%isnot]=""
#text(x=mm,y=-10,num)
mtext(side=1,at = mm,num,cex=0.8,line=1)
legend("topright",legend=c("no mod.",rownames(nr)),fill=cols[length(cols):(length(cols)-need+1)])
mm = barplot(t(matt[,ncol(matt):1]),col=cols[(length(cols)-need+1):length(cols)],border = NA)
uu = rep("",nrow(matt))
isnot = which(rowSums(matt[,2:ncol(matt)])>0)
uu[isnot]=tt[isnot]
mtext(side=1,at = mm,uu,cex=0.8)
num=1:length(tt)
num[!num%in%isnot]=""
#text(x=mm,y=-10,num)
mtext(side=1,at = mm,num,cex=0.8,line=1,las=2)
mm = barplot(t(matt[,ncol(matt):1]),col=cols[(length(cols)-need+1):length(cols)],border = NA)
uu = rep("",nrow(matt))
isnot = which(rowSums(matt[,2:ncol(matt)])>0)
uu[isnot]=tt[isnot]
mtext(side=1,at = mm,uu,cex=0.8)
num=1:length(tt)
num[!num%in%isnot]=""
#text(x=mm,y=-10,num)
mtext(side=1,at = mm,num,cex=0.6,line=1,las=2)
legend("topright",legend=c("no mod.",rownames(nr)),fill=cols[length(cols):(length(cols)-need+1)])
rm(list=ls())
library(stringr)
indata = read.csv("/Users/elin.axelsson/Desktop/MS_H31_H33_allmodifications.csv",skip=2,sep=";",dec=",")
fasta = "MARTKQTARKSHGGKAPRTLLATKAARKSAPTTGGVKKPHRYRPGTVALREIRKYQKSTELLIRKLPFQRLVREIAQDYKTDLRFQSHAVLALQEAAEAYLVGLFEDTNLCAIHAKRVTIMPKDVQLARRIRGERA*"
fasta="MARTKQTARKSTGGKAPRKQLATKAARKSAPATGGVKKPHRFRPGTVALREIRKYQKSTELLIRKLPFQRLVREIAQDFKTDLRFQSSAVAALQEAAEAYLVGLFEDTNLCAIHAKRVTIMPKDIQLARRIRGERA*"
index=grep("AT3G27360\\|H3.1",indata$Accession)
indind=indata[index,]
ProteinPlot(fasta,indind)
rm(list=ls())
source('~/glans/app2/test2.R')
rm(list=ls())
source('~/glans/app2/test2.R')
source('~/glans/app2/test2.R')
head(indind)
source('~/glans/app2/test2.R')
mm
head(mm)
source('~/glans/app2/test2.R')
head(mm)
source('~/glans/app2/test2.R')
source('~/glans/app2/test2.R')
source('~/glans/app2/test2.R')
source('~/glans/app2/test2.R')
source('~/glans/app2/test2.R')
source('~/glans/app2/test2.R')
source('~/glans/app2/test2.R')
source('~/glans/app2/test2.R')
source('~/glans/app2/test2.R')
mm = ProteinPlot(fasta,indind)
source('~/glans/app2/test2.R')
source('~/glans/app2/test2.R')
mm
source('~/glans/app2/test2.R')
head(mm)
source('~/glans/app2/test2.R')
head(mm)
mm
mm[rowSums(mm)>0,]
mm[rowSums(mm[,-1])>0,]
mm[rowSums(mm[,-1])>0,-1]
sum(mm[,1]>0)/sum(mm[,1]>-1)
sum(mm[,1]>-1
)
um(mm[,1]>0)
sum(mm[,1]>0)a
sum(mm[,1]>0)
sum(mm)
nrow(indind)
modif.counts=sum(mm[,-1])
modif.counts
modif=ncol(mm)-1
modif
summaryFunction <- function(mm,indind){
cov=sum(mm[,1]>0)/sum(mm[,1]>-1)
counts=nrow(indind)
modif=ncol(mm)-1
modif.counts=sum(mm[,-1])
mysum = data.frame(coverage=cov,nr.peptides=counts,modification_types=modif,modifications_detected=modif.counts)
}
summaryFunction(mm,indind)
a = summaryFunction(mm,indind)
a
mm
levelplot(mm)
library(gplots)
levelplot(mm)
library(geneplotter)
levelplot(mm)
head(mm)
modonly = mm[rowSums(mm[,-1])>0,-1]
modonly
levelplot(modonly)
heatmap(modonly)
heatmap.2(modonly)
heatmap.2(modonly,scale=row)
?heatmap.2
heatmap.2(modonly,scale="row")
heatmap.2(modonly,scale="row",dendrogram="none")
heatmap.2(modonly,scale="row",dendrogram="none",Rowv = F)
heatmap.2(modonly,scale="row",dendrogram="none",Rowv = F,Colv=F)
heatmap.2(modonly,scale="row",dendrogram="none",Rowv = F,Colv=F,trace=F)
heatmap.2(modonly,scale="row",dendrogram="none",Rowv = F,Colv=F,trace="n")
modonly = mm[rowSums(mm[,-1])>0,]
heatmap.2(modonly,scale="row",dendrogram="none",Rowv = F,Colv=F,trace="n")
heatmap.2(modonly,scale="n",dendrogram="none",Rowv = F,Colv=F,trace="n")
heatmap.2(modonly,scale="n",dendrogram="none",Rowv = F,Colv=F,trace="row")
modonly
barplot(modonly)
barplot(t(modonly))
barplot(t(modonly),las=2)
modonly
